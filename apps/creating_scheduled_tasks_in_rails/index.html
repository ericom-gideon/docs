<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="msvalidate.01" content="30681728D02314C28E73C01119E51FE8" />
        
        
        <link rel="canonical" href="http://help.ninefold.com/apps/creating_scheduled_tasks_in_rails/">
        <link rel="shortcut icon" href="../../img/favicon.ico">

        <title>Creating scheduled tasks - Ninefold</title>

        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/prettify-1.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

       <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-20888012-1', 'auto');
            ga('send', 'pageview');

        </script>

        <script>
          (function() {
            var cx = '007510500888672052678:j-vcw1lhenu';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
                '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
        </script>

        <script type="text/javascript">
            var __lc = {};
            __lc.license = 1076997;

            (function() {
                var lc = document.createElement('script'); lc.type = 'text/javascript'; lc.async = true;
                lc.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'cdn.livechatinc.com/tracking.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(lc, s);
            })();
        </script>
        
    </head>

    <body>

        <div id="ninefold-nav" class="navbar navbar-inverse " role="navigation">
    <div class="container">
        <div class="ninefold-nav">
            <div class="navbar-header">
                <a title="Ninefold" class="mast__topbar__logo logo" href="https://ninefold.com"></a>
              
                
           
            </div>
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".nine-navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <div class="collapse nine-navbar-collapse navbar-collapse">
                <ul class="nav navbar-nav">
                <li>
                  <a href="https://ninefold.com/pricing-detail">Pricing</a>
                </li>
                <li>
                  <a href="https://ninefold.com/news">News</a>
                </li>
                <li>
                  <a href="https://ninefold.com/about-us">About Us</a>
                </li>
                <li class="active">
                  <a href="http://help.ninefold.com">Docs</a>
                </li>
                <li class="signin">
                  <a href="http://portal.ninefold.com">Sign in</a>
                </li>
                </ul>
            </div>

        </div>
    </div>

</div>
<div class="main-nav">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".main-navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <i class="fa fa-chevron-down"></i>
            </button>

            <!-- Main title -->
            <!-- <a class="navbar-brand" href="../..">Ninefold</a> -->
        </div>

        <!-- Expanded navigation -->
        <div class="main-navbar-collapse navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../getstarted/how_to_deploy_an_app">Deploy an app</a>
                        </li>
                    
                        <li >
                            <a href="../../getstarted/how_to_install_and_utilize_the_cli">Utilize the CLI</a>
                        </li>
                    
                        <li >
                            <a href="../../getstarted/how_to_migrate_from_heroku">Migrating from Heroku</a>
                        </li>
                    
                        <li >
                            <a href="../../getstarted/how_ninefold_works_with_github_bitbucket_and_git_url">GitHub, Bitbucket and Git URL</a>
                        </li>
                    
                        <li >
                            <a href="../../getstarted/how_to_utilize_ninefold_logging">Ninefold logging</a>
                        </li>
                    
                        <li >
                            <a href="../../getstarted/exporting_and_importing_postgresql_data">Exporting and importing PostgreSQL data</a>
                        </li>
                    
                        <li >
                            <a href="../../getstarted/how_to_deploy_diaspora">Deploy Diaspora</a>
                        </li>
                    
                        <li >
                            <a href="../../getstarted/how_to_deploy_spree">Deploy Spree</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">App Deployment <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../what_is_a_procfile">Configuring your procfile</a>
                        </li>
                    
                        <li >
                            <a href="../sidekiq">Implementing Sidekiq</a>
                        </li>
                    
                        <li >
                            <a href="../deployment_with_continuous_integration_ci">Deployment with CI</a>
                        </li>
                    
                        <li >
                            <a href="../deploying_a_rails_app_with_your_own_database">Deploying a Rails app with your own database</a>
                        </li>
                    
                        <li >
                            <a href="../asset_precompile_on_ninefold">Asset precompilation</a>
                        </li>
                    
                        <li >
                            <a href="../setting_up_deployment_notifications">Deployment notifications</a>
                        </li>
                    
                        <li >
                            <a href="../zero_downtime_deployment_for_your_ninefold_rails_app">Zero downtime deployment</a>
                        </li>
                    
                        <li >
                            <a href="../setting_and_changing_your_apps_configuration">App configuration and infrastructure</a>
                        </li>
                    
                        <li >
                            <a href="../private_gem_repos_on_github_and_bitbucket">Private gem repos</a>
                        </li>
                    
                        <li >
                            <a href="../what_happens_and_what_gets_built_on_a_rails_app_deployment">What happens during deployment</a>
                        </li>
                    
                        <li >
                            <a href="../ssl_management_for_rails_apps">SSL for Rails apps</a>
                        </li>
                    
                        <li >
                            <a href="../dns_management_for_rails_apps">DNS management for Rails apps</a>
                        </li>
                    
                        <li >
                            <a href="../setup_elasticsearch">Setup Elasticsearch</a>
                        </li>
                    
                        <li >
                            <a href="../adding_sendgrid_to_your_rails_app">Adding SendGrid</a>
                        </li>
                    
                        <li >
                            <a href="../redisforapps">Redis Setup</a>
                        </li>
                    
                        <li class="active">
                            <a href=".">Creating scheduled tasks</a>
                        </li>
                    
                        <li >
                            <a href="../backing_up_and_restoring_your_rails_db">Backup and restore your database</a>
                        </li>
                    
                        <li >
                            <a href="../redeploying_an_app">Redeploying an app</a>
                        </li>
                    
                        <li >
                            <a href="../postgres_and_postgis_and_modules">PostgreSQL, PostGIS, and PostgreSQL modules</a>
                        </li>
                    
                        <li >
                            <a href="../how_to_utilize_a_cdn_with_ninefold">How to utilize a CDN</a>
                        </li>
                    
                        <li >
                            <a href="../upgrading_from_rails_40_to_41">Upgrading from Rails 4.0 to 4.1</a>
                        </li>
                    
                        <li >
                            <a href="../unicorn">Setup with Unicorn</a>
                        </li>
                    
                        <li >
                            <a href="../puma">Setup with Puma</a>
                        </li>
                    
                        <li >
                            <a href="../thin">Setup with Thin</a>
                        </li>
                    
                        <li >
                            <a href="../faq">FAQ</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Servers <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../servers/how_to_create_a_docker_server">Docker containers</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/create">Create a server</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/resize">Resize your server</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/liveview">Access your server with live view</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/how_to_clone_your_server">Clone a server</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/how_to_attach_and_upload_an_iso">Upload and attach an ISO</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/how_to_create_a_template_from_your_server">Create a template from your server</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/moving">Copying or moving servers between regions</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/how_to_add_storage_volumes">Add storage volumes</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/how_to_view_attached_and_detached_storage_volumes">View attached/detached storage volumes</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/how_to_detach_then_reattach_a_storage_volume">Detach then reattach a storage volume</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/using_backups_to_protect_your_data">Using backups to protect your data</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/new_server_username_and_password">New server username and password</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/resetting_server_password">Reset your server password</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/how_to_connect_to_your_server_using_ssh_rdp">Connect using SSH / RDP</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/how_to_activate_windows_server">Activate Windows Server</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/microsoft_licensing_can_i_use_my_existing_software_and_licenses_on_ninefold">Microsoft licensing</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/faq">FAQ</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Networking <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../networking/ninefold_net">Enable Ninefold Net</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/dns_management_for_servers">DNS management for servers</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/setup_load_balancing_single_zone">Setup load balancing</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/setting_up_static_nat_and_port_forward_for_ip_addresses">Static NAT & port forward</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/how_to_open_firewall_ports">Open firewall ports</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/disable_server_os_firewall">Disable server OS firewall</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/how_to_setup_global_load_balancing_for_servers">Global load balancing</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/how_to_delegate_your_domain_to_ninefold">Delegate your domain</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/how_to_release_or_unassign_your_ip_addresses">How to release or unassign your IP addresses</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/how_to_use_multiple_ip_addresses_on_a_server">How to use multiple IP addresses</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Accounts & Billing <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../billing/freetrial">Free trial</a>
                        </li>
                    
                        <li >
                            <a href="../../billing/createuser">Creating additional users</a>
                        </li>
                    
                        <li >
                            <a href="../../billing/closeaccount">How to close your account</a>
                        </li>
                    
                        <li >
                            <a href="../../billing/faq">Billing FAQ</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../reference/support-policy">Support Policy</a>
                        </li>
                    
                        <li >
                            <a href="../../reference/faq">FAQ</a>
                        </li>
                    
                        <li >
                            <a href="../../reference/apdex">Apdex to measure user satisfaction</a>
                        </li>
                    
                        <li >
                            <a href="../../reference/API">Using the API (v2)</a>
                        </li>
                    
                        <li >
                            <a href="../../reference/contributing">Contribute to our docs</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-left">
                
                
                <li>
                    <a href="#searchModal" data-toggle="modal"><i class="fa fa-search"></i></a>
 
                </li>
            
                
                <!-- 
                <li>
                    <a href="https://github.com/ninefold/docs/">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                 -->
            </ul>
        </div>
    </div>
</div>

        <div class="container-fluid">
         
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#creating-scheduled-tasks">Creating scheduled tasks</a></li>
        
            <li class="subsection"><a href="#scheduling">Scheduling</a></li>
        
            <li class="subsection"><a href="#whenever-gem">Whenever gem</a></li>
        
            <li class="subsection"><a href="#create-a-config-file">Create a config file</a></li>
        
            <li class="subsection"><a href="#post_migration-trigger">Post_migration trigger</a></li>
        
            <li class="subsection"><a href="#commit">Commit</a></li>
        
            <li class="subsection"><a href="#environment-vars">Environment vars</a></li>
        
            <li class="subsection"><a href="#logging">Logging</a></li>
        
    
    </ul>
</div></div>

            <div class="col-md-9" role="main">

                <div class="col-md-12 hidden-xs hidden-sm">
                    <a href="https://github.com/ninefold/docs/tree/master/docs/apps/creating_scheduled_tasks_in_rails.md" class="github-btn btn btn-default pull-right"> <span class="fa fa-github"></span> Edit on GitHub</a>
                </div>
                <div class="col-md-12 hidden-xs hidden-sm"></br></div>
                
                   

<h2 id="creating-scheduled-tasks">Creating scheduled tasks</h2>
<h4 id="scheduling">Scheduling</h4>
<p>Maybe you’ve got some rake tasks that need to be run every morning. Or maybe you’ve got source some data from an external web service and load it into a your database. Whatever task it is, it’s got to be on a schedule. It’s pretty easy to do with Ninefold.</p>
<p>So the popular way to do this is to schedule a ‘cron’ job to run your commands using the ‘Whenever’ gem. Here’s how.</p>
<h4 id="whenever-gem">Whenever gem</h4>
<p>Add the whenever gem to your Gemfile:</p>
<pre><code>gem 'whenever', :require =&gt; false
</code></pre>
<p>Then install the gem in your local environment:</p>
<pre><code>$ bundle install
</code></pre>
<h4 id="create-a-config-file">Create a config file</h4>
<p>Create your initial config file in your app:</p>
<pre><code>$ cd /rails_apps/my_awesome_app
$ wheneverize .
</code></pre>
<p>This will create <code>config/schedule.rb</code> which gives some examples to use. Type your cron tasks in <code>config/schedule.rb</code>. For examples of some cron schedules, go here: <a href="https://www.github.com/javan/whenever">Whenever gem</a></p>
<h4 id="post_migration-trigger">Post_migration trigger</h4>
<p>In your Ninefold app, go to the <strong>Configuration</strong> tab &gt; <strong>Deployment Triggers</strong>, in the <em>After Migrations</em> section type:</p>
<pre><code>$ bundle exec whenever --update-crontab my_awesome_app
</code></pre>
<p>Where <code>my_awesome_app</code> is what you'd like to name your cron task. You can use this name or use your own, but isn't your app already awesome? Press <em>Update triggers</em> to save.</p>
<h4 id="commit">Commit</h4>
<pre><code>$ git add .
$ git commit -m "Adding cron jobs using whenever"
$ git push origin my_ninefold_deploy_branch
</code></pre>
<p>If autodeploy is turned on, Ninefold will redeploy for you automatically after you've pushed your changes to the repo. If not, a manual redeploy is needed. In portal, press the red <strong>Redeploy Now</strong>.</p>
<p>Cron tasks will be run from the root directory of your app. If you've got multiple web and worker servers, cron tasks currently will run on ALL your web and worker servers by default. If you would like to have the cron task run ONLY on certain servers, please submit a ticket, and we will provide you details on how to do this.</p>
<h4 id="environment-vars">Environment vars</h4>
<p>You can use defined environment variables in whenever gem constructed cron tasks. Simply add an env line for each of your environment vars in config/schedule.rb:</p>
<pre><code>### schedule.rb
env :SAMPLE_VAR, ENV['SAMPLE_VAR']
env :ANOTHER_SAMPLE_VAR, ENV['ANOTHER_SAMPLE_VAR']
env :MANUALLY_DEFINED_VAR, "This is a manually defined environment variable."
every 15.minutes do
  command "echo \"I am running from cron! Environment variable value: ${SAMPLE_VAR}\""
end
</code></pre>
<h4 id="logging">Logging</h4>
<p>The whenever gem comes with the ability to set the output to a log file. To do this on Ninefold, add the line below to the <code>config/schedule.rb</code> file. This will allow for your output to be directed to the <em>After Migrations</em> trigger log, which is viewable in the CLI as well as in the <strong>Logs</strong> viewer (Sources &gt; Triggers).</p>
<pre><code>set :output, '/var/www/apps/YOUR_APP_ID/current/log/custom_deploy_after_migrate.log'
</code></pre>
<p><code>YOUR_APP_ID</code> is the App ID found in the URL: <code>portal.ninefold.com/apps/#####</code> or via the CLI: <code>$ ninefold app list</code>.</p>
<p>For more information about output redirection with the whenever gem, <a href="https://github.com/javan/whenever/wiki/Output-redirection-aka-logging-your-cron-jobs">click here</a>.</p>


</br></br></br></br>
            </div>
        </div>

        <div class="modal fade" id="searchModal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="searchModalLabel">Documentation search</h4>
      </div>
      <div class="modal-body">

        <form onsubmit="return executeQuery();" id="cse-search-box-form-id">
          <input type="search" class="form-control" id="cse-search-input-box-id" placeholder="Search">
        </form>

        <script type="text/javascript">
          function executeQuery() {
            var input = document.getElementById('cse-search-input-box-id');
            var element = google.search.cse.element.getElement('searchresults-only0');
            if (input.value == '') {
              element.clearAllResults();
            } else {
              element.execute(input.value);
            }
            return false;
          }
        </script>


        <gcse:searchresults-only></gcse:searchresults-only>
       
      </div>
    </div>
  </div>
</div>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        <script src="../../js/prettify-1.0.min.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>