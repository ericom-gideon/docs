<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="msvalidate.01" content="30681728D02314C28E73C01119E51FE8" />
        
        
        <link rel="canonical" href="http://help.ninefold.com/servers/how_to_create_a_coreos_server/">
        <link rel="shortcut icon" href="../../img/favicon.ico">

        <title>Create a CoreOS Server - Ninefold</title>

        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/prettify-1.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

       <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-20888012-1', 'auto');
            ga('send', 'pageview');

        </script>

        <script>
          (function() {
            var cx = '007510500888672052678:j-vcw1lhenu';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
                '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
        </script>

        <script type="text/javascript">
            var __lc = {};
            __lc.license = 1076997;

            (function() {
                var lc = document.createElement('script'); lc.type = 'text/javascript'; lc.async = true;
                lc.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'cdn.livechatinc.com/tracking.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(lc, s);
            })();
        </script>
        
    </head>

    <body>

        <div id="ninefold-nav" class="navbar navbar-inverse " role="navigation">
    <div class="container">
        <div class="ninefold-nav">
            <div class="navbar-header">
                <a title="Ninefold" class="mast__topbar__logo logo" href="https://ninefold.com"></a>
              
                
           
            </div>
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".nine-navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <div class="collapse nine-navbar-collapse navbar-collapse">
                <ul class="nav navbar-nav">
                <li>
                  <a href="https://ninefold.com/pricing">Pricing</a>
                </li>
                <li>
                  <a href="https://ninefold.com/features">Features</a>
                </li>
                <li>
                  <a href="https://ninefold.com/dcaas-government-cloud-hosting">Government</a>
                </li>
                 <li>
                  <a href="https://ninefold.com/partners">Partners</a>
                </li>
                <li>            
                  <a href="https://ninefold.com/news">News</a>
                </li>
                <li>
                  <a href="https://ninefold.com/about-us">About Us</a>
                </li>
                <li class="active">
                  <a href="http://help.ninefold.com">Docs</a>
                </li>
                <li class="signin">
                  <a href="http://portal.ninefold.com">Sign in</a>
                </li>
                </ul>
            </div>

        </div>
    </div>

</div>
<div class="main-nav">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".main-navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <i class="fa fa-chevron-down"></i>
            </button>

            <!-- Main title -->
            <!-- <a class="navbar-brand" href="../..">Ninefold</a> -->
        </div>

        <!-- Expanded navigation -->
        <div class="main-navbar-collapse navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../create">Create Your Server</a>
                        </li>
                    
                        <li >
                            <a href="../new_server_username_and_password">Finding your server username and password</a>
                        </li>
                    
                        <li >
                            <a href="../how_to_connect_to_your_server_using_ssh_rdp">Connecting to your server</a>
                        </li>
                    
                        <li >
                            <a href="../resize">Resize your server CPU and RAM</a>
                        </li>
                    
                        <li >
                            <a href="../how_to_create_a_docker_server">Creating a Docker Server</a>
                        </li>
                    
                        <li >
                            <a href="../faq">Virtual Servers FAQ</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">App Deployment <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../apps/how_to_migrate_your_rails_app_off_of_ninefold">How to Migrate from Ninefold</a>
                        </li>
                    
                        <li >
                            <a href="../../reference/faq_rails_us_sunset">FAQ - Rails and US sunsetting</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/what_is_a_procfile">Configuring your procfile</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/sidekiq">Implementing Sidekiq</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/deployment_with_continuous_integration_ci">Deployment with CI</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/deploying_a_rails_app_with_your_own_database">Deploying a Rails app with your own database</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/asset_precompile_on_ninefold">Asset precompilation</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/setting_up_deployment_notifications">Deployment notifications</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/zero_downtime_deployment_for_your_ninefold_rails_app">Zero downtime deployment</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/setting_and_changing_your_apps_configuration">App configuration and infrastructure</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/private_gem_repos_on_github_and_bitbucket">Private gem repos</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/what_happens_and_what_gets_built_on_a_rails_app_deployment">What happens during deployment</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/ssl_management_for_rails_apps">SSL for Rails apps</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/dns_management_for_rails_apps">DNS management for Rails apps</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/setup_elasticsearch">Setup Elasticsearch</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/adding_sendgrid_to_your_rails_app">Adding SendGrid</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/redisforapps">Redis Setup</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/creating_scheduled_tasks_in_rails">Creating scheduled tasks</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/backing_up_and_restoring_your_rails_db">Backup and restore your database</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/redeploying_an_app">Redeploying an app</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/postgres_and_postgis_and_modules">PostgreSQL, PostGIS, and PostgreSQL modules</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/how_to_utilize_a_cdn_with_ninefold">How to utilize a CDN</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/upgrading_from_rails_40_to_41">Upgrading from Rails 4.0 to 4.1</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/unicorn">Setup with Unicorn</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/puma">Setup with Puma</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/thin">Setup with Thin</a>
                        </li>
                    
                        <li >
                            <a href="../../apps/faq">FAQ</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Virtual Servers <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../how_to_create_a_docker_server">Create a Docker Server</a>
                        </li>
                    
                        <li >
                            <a href="../create">Create a Virtual Server</a>
                        </li>
                    
                        <li class="active">
                            <a href=".">Create a CoreOS Server</a>
                        </li>
                    
                        <li >
                            <a href="../new_server_username_and_password">New server username and password</a>
                        </li>
                    
                        <li >
                            <a href="../resetting_server_password">Reset your server password</a>
                        </li>
                    
                        <li >
                            <a href="../resize">Resize your server</a>
                        </li>
                    
                        <li >
                            <a href="../liveview">Access your server with live view</a>
                        </li>
                    
                        <li >
                            <a href="../how_to_connect_to_your_server_using_ssh_rdp">Connect using SSH / RDP</a>
                        </li>
                    
                        <li >
                            <a href="../ssh_keys">SSH Keys</a>
                        </li>
                    
                        <li >
                            <a href="../user_data">User Data</a>
                        </li>
                    
                        <li >
                            <a href="../managing_storage_and_backups">Manage Storage & Backups</a>
                        </li>
                    
                        <li >
                            <a href="../how_to_clone_your_server">Clone a server</a>
                        </li>
                    
                        <li >
                            <a href="../how_to_attach_and_upload_an_iso">Upload and attach an ISO</a>
                        </li>
                    
                        <li >
                            <a href="../how_to_create_a_template_from_your_server">Create a template from your server</a>
                        </li>
                    
                        <li >
                            <a href="../how_to_activate_windows_server">Activate Windows Server</a>
                        </li>
                    
                        <li >
                            <a href="../microsoft_licensing_can_i_use_my_existing_software_and_licenses_on_ninefold">Microsoft licensing</a>
                        </li>
                    
                        <li >
                            <a href="../faq">FAQ</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Networking <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../networking/ninefold_net">Enable Ninefold Net</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/dns_management_for_servers">DNS management for servers</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/setup_load_balancing_single_zone">Setup load balancing</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/setting_up_static_nat_and_port_forward_for_ip_addresses">Static NAT & port forward</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/how_to_open_firewall_ports">Open firewall ports</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/disable_server_os_firewall">Disable server OS firewall</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/how_to_setup_global_load_balancing_for_servers">Global load balancing</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/how_to_delegate_your_domain_to_ninefold">Delegate your domain</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/how_to_release_or_unassign_your_ip_addresses">How to release or unassign your IP addresses</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/how_to_use_multiple_ip_addresses_on_a_server">How to use multiple IP addresses</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Accounts & Billing <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../billing/createuser">Creating additional users</a>
                        </li>
                    
                        <li >
                            <a href="../../billing/closeaccount">How to close your account</a>
                        </li>
                    
                        <li >
                            <a href="../../billing/billing_process">Ninefold Billing Process</a>
                        </li>
                    
                        <li >
                            <a href="../../billing/faq">Billing FAQ</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../reference/support-policy">Support Policy</a>
                        </li>
                    
                        <li >
                            <a href="../../reference/faq">General FAQ</a>
                        </li>
                    
                        <li >
                            <a href="../../reference/API">Using the API (v2)</a>
                        </li>
                    
                        <li >
                            <a href="../../reference/contributing">Contribute to our docs</a>
                        </li>
                    
                        <li >
                            <a href="../../reference/faq_rails_us_sunset">FAQ - Rails and US sunsetting</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-left">
                
                
                <li>
                    <a href="#searchModal" data-toggle="modal"><i class="fa fa-search"></i></a>
 
                </li>
            
                
                <!-- 
                <li>
                    <a href="https://github.com/ninefold/docs/">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                 -->
            </ul>
        </div>
    </div>
</div>

        <div class="container-fluid">
         
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#create-a-coreos-server">Create a CoreOS server</a></li>
        
    
        <li class="main "><a href="#to-add-additional-storage">To add additional storage</a></li>
        
    
        <li class="main "><a href="#doing-something-with-coreos">Doing something with CoreOS</a></li>
        
            <li class="subsection"><a href="#install-fleet-on-your-local-osx-darwin-or-linux-amd64-computer">Install fleet on your local OSX (darwin) or linux (amd64) computer</a></li>
        
            <li class="subsection"><a href="#get-something-running-on-your-cluster">Get something running on your cluster</a></li>
        
    
    </ul>
</div></div>

            <div class="col-md-9" role="main">

                <div class="col-md-12 hidden-xs hidden-sm">
                    <a href="https://github.com/ninefold/docs/tree/master/docs/servers/how_to_create_a_coreos_server.md" class="github-btn btn btn-default pull-right"> <span class="fa fa-github"></span> Edit on GitHub</a>
                </div>
                <div class="col-md-12 hidden-xs hidden-sm"></br></div>
                
                   

<h2 id="create-a-coreos-server">Create a CoreOS server</h2>
<p><a href="https://coreos.com">CoreOS</a> is a minimalistic linux distribution that has been written to run distributed, scalable applications and services with high resiliency.</p>
<p>Deploying CoreOS on Ninefold is simple thanks to our CoreOS template and <a href="../user_data">user data</a> functionality.</p>
<p>The CoreOS template is set up based on the Cloudstack OEM overlay, which means during startup the cloud-config settings will be read from user data and appropriate service initialisation will take place.</p>
<p>You can't log on to CoreOS without SSH keys, so make sure you set up your <a href="../ssh_keys">ssh keypair</a> on Ninefold or you won't be able to get on to any machine in your CoreOS cluster.</p>
<p>From the Ninefold Dashboard click to create a <a href="https://portal.ninefold.com/servers/new">New Server</a>. Ensure these components are selected when deploying your CoreOS instance:</p>
<ul>
<li>Memory &amp; CPU: go for a minimum of 2GB-X2 (if you go lower, the OS may not boot). Choose a compute size that's suitable for your needs. You can resize at any time, but we advise keeping all CoreOS machines in a cluster the same size.</li>
<li>Image: CoreOS (we only supply the latest stable version)</li>
<li>In Additional options, select and specify <a href="../user_data">user data</a></li>
<li>Regardless of whether you intend to set up a CoreOS cluster, you'll need a <a href="https://coreos.com/docs/cluster-management/setup/cluster-discovery/">unique discovery URL</a> which will allow machines in the cluster to communicate</li>
<li>In the <a href="../user_data">user data</a> text area specify your <a href="https://coreos.com/docs/cluster-management/setup/cloudinit-cloud-config/">cloud-config</a>. Below we've provided an example that will get you running with etcd, fleet and docker. Remember to replace the etcd discovery attribute with the actual CoreOS discovery URL.</li>
</ul>
<pre><code>#cloud-config

coreos:
  update:
    reboot-strategy: best-effort
  etcd:
    discovery: https://discovery.etcd.io/youruniquediscoveryurltokenhere
    addr: $private_ipv4:4001
    peer-addr: $private_ipv4:7001
  fleet:
    public-ip: $private_ipv4
  units:
    - name: etcd.service
      command: start
    - name: fleet.service
      command: start
</code></pre>

<p>Click Deploy and the server is up and running in just a couple of minutes with 80Gb of attached local disk. You'll be in a great spot if you've added <a href="../ssh_keys">ssh keys</a> because you'll be able to SSH straight onto your machine.</p>
<p><code>ssh core@(publicipaddress)</code></p>
<p>If you forgot to add an <a href="../ssh_keys">SSH key</a>, you can do so at any time.</p>
<h2 id="to-add-additional-storage">To add additional storage</h2>
<ul>
<li>Click on the Storage link against your CoreOS machine in the Ninefold portal</li>
<li>Use the New disk form to add a new disk</li>
<li>SSH onto your VM, and find /dev/xvdb (increment b by 1 letter for each additional volume)</li>
<li>To add additional disk to CoreOS or Docker, follow this CoreOS guide on <a href="https://coreos.com/docs/cluster-management/setup/mounting-storage/">mounting storage</a>.</li>
</ul>
<h2 id="doing-something-with-coreos">Doing something with CoreOS</h2>
<p>You've got a server running, but that's not much without doing something with it. There are many examples on the internet and we prefer to leave it to the experts, but we'll get you up and running with something that will make you cheer.</p>
<p>We'll utilise fleet. Fleet is like a distributed init system. You interact with it in a simple and intuitive way by submitting, stopping and starting units via <a href="https://coreos.com/docs/launching-containers/launching/fleet-using-the-client/">fleetctl</a>.</p>
<p>Fleetctl is a command that talks via API and helps you control executable units across your cluster. You can use <em>fleetctl</em> on your Ninefold CoreOS server or you can run it from your local machine and control a remote cluster.</p>
<p><code>Note: you should run the same version of fleetctl on your local machine as you do on your server. fleetctl --version will help pave the way.</code></p>
<h3 id="install-fleet-on-your-local-osx-darwin-or-linux-amd64-computer">Install fleet on your local OSX (darwin) or linux (amd64) computer</h3>
<p>You could use fleetctl on the Server you've created, but that would be no fun. You can control your fleet cluster right from the comfort of your own computer. Fleet makes this really simple, it just tunnels through an SSH connection to make it happen.</p>
<ul>
<li>Visit <a href="https://github.com/coreos/fleet/releases">https://github.com/coreos/fleet/releases</a>. You'll need to find the appropriate binary download for the fleet version on your CoreOS server <code>fleetctl --version</code>. Download it and install it to a location on your machine that's on your path.</li>
<li>Ensure you've started your SSH user agent: <code>eval $(ssh-agent)</code></li>
<li>Add your private key to your agent: <code>ssh-add</code> (you will need to enter your private key password if you've set one)</li>
<li>From your terminal <code>export FLEETCTL_TUNNEL=(yourserverpublicipaddress)</code></li>
</ul>
<p>Run <code>fleetctl list-machines</code> and fleet should come back with a list of machines currently registered in your cluster.</p>
<p><img alt="fleet list-machines" src="../../../../img/fleetlistmachines.png" /></p>
<h3 id="get-something-running-on-your-cluster">Get something running on your cluster</h3>
<p>In this example we'll use one of CoreOS' examples of running an apache frontend in <a href="https://coreos.com/docs/launching-containers/launching/launching-containers-fleet/">high availability</a> mode.</p>
<p>Fortunately, by default we open the HTTP firewall port server's IP address, so you won't need to fiddle with your Ninefold server at all.</p>
<p>To get apache up and running:</p>
<ul>
<li>Create yourself a unit template file anywhere on your machine (call it apache@.service):</li>
</ul>
<pre><code>[Unit]
Description=My Apache Frontend
After=docker.service
Requires=docker.service

[Service]
TimeoutStartSec=0
ExecStartPre=-/usr/bin/docker kill apache1
ExecStartPre=-/usr/bin/docker rm apache1
ExecStartPre=/usr/bin/docker pull coreos/apache
ExecStart=/usr/bin/docker run -rm --name apache1 -p 80:80 coreos/apache /usr/sbin/apache2ctl -D FOREGROUND
ExecStop=/usr/bin/docker stop apache1

[X-Fleet]
Conflicts=apache@*.service
</code></pre>

<ul>
<li>Submit your new apache template to fleet: <code>fleetctl submit apache@.service</code></li>
<li><code>fleetctl start apache@1</code></li>
<li>If you have more than one machine in your fleet cluster, keep running the previous command, incrementing the number after the @ sign by one each time. If you exceed the number of machines in your cluster, the service will bank up waiting for a free machine to run on.</li>
</ul>
<p>Once you're done, hit any of your machine's public ip addresses from your web browser (http://<em>youripaddress</em>), and walla, apache will tell you <em>It works!</em>.</p>
<p>How does it work? Well the unit file you submitted and started runs a standard coreos/apache docker container, and exposes it on public port 80.</p>
<p>For comprehensive information on interacting with units, see <a href="https://coreos.com/docs/launching-containers/launching/fleet-using-the-client/">CoreOS's excellent guide</a>.</p>
<p>CoreOS is such a step forward when it comes to deploying distributed, scalable applications and services. We know you'll love it. While it does take a bit of getting used to, you're surely hooked after getting this simple example running.</p>


</br></br></br></br>
            </div>
        </div>

        <div class="modal fade" id="searchModal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="searchModalLabel">Documentation search</h4>
      </div>
      <div class="modal-body">

        <form onsubmit="return executeQuery();" id="cse-search-box-form-id">
          <input type="search" class="form-control" id="cse-search-input-box-id" placeholder="Search">
        </form>

        <script type="text/javascript">
          function executeQuery() {
            var input = document.getElementById('cse-search-input-box-id');
            var element = google.search.cse.element.getElement('searchresults-only0');
            if (input.value == '') {
              element.clearAllResults();
            } else {
              element.execute(input.value);
            }
            return false;
          }
        </script>


        <gcse:searchresults-only></gcse:searchresults-only>
       
      </div>
    </div>
  </div>
</div>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        <script src="../../js/prettify-1.0.min.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>